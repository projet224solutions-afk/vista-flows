# üîí S√âCURIT√â ENTERPRISE GLOBALE - 224SOLUTIONS
# Configuration pour 100M utilisateurs

apiVersion: v1
kind: Namespace
metadata:
  name: security-224solutions
  labels:
    app: security
    tier: enterprise
    compliance: "SOC2,ISO27001,GDPR"

---
# üîê AUTHENTIFICATION MULTI-NIVEAUX
apiVersion: apps/v1
kind: Deployment
metadata:
  name: auth-service
  namespace: security-224solutions
spec:
  replicas: 10
  selector:
    matchLabels:
      app: auth-service
  template:
    metadata:
      labels:
        app: auth-service
    spec:
      containers:
      - name: auth-service
        image: 224solutions/auth-service:latest
        ports:
        - containerPort: 3000
        env:
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: jwt-secret
              key: secret
        - name: OAUTH_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name: oauth-secret
              key: client-id
        - name: OAUTH_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name: oauth-secret
              key: client-secret
        - name: BIOMETRIC_API_KEY
          valueFrom:
            secretKeyRef:
              name: biometric-secret
              key: api-key
        - name: HARDWARE_SECURITY_KEY
          valueFrom:
            secretKeyRef:
              name: hardware-secret
              key: key
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"
        securityContext:
          allowPrivilegeEscalation: false
          runAsNonRoot: true
          runAsUser: 1000
          capabilities:
            drop:
            - ALL

---
# üõ°Ô∏è CHIFFREMENT GLOBAL
apiVersion: apps/v1
kind: Deployment
metadata:
  name: encryption-service
  namespace: security-224solutions
spec:
  replicas: 5
  selector:
    matchLabels:
      app: encryption-service
  template:
    metadata:
      labels:
        app: encryption-service
    spec:
      containers:
      - name: encryption-service
        image: 224solutions/encryption-service:latest
        ports:
        - containerPort: 3001
        env:
        - name: AES_256_KEY
          valueFrom:
            secretKeyRef:
              name: aes-secret
              key: key
        - name: RSA_4096_PRIVATE_KEY
          valueFrom:
            secretKeyRef:
              name: rsa-secret
              key: private-key
        - name: RSA_4096_PUBLIC_KEY
          valueFrom:
            secretKeyRef:
              name: rsa-secret
              key: public-key
        - name: QUANTUM_RESISTANT_KEY
          valueFrom:
            secretKeyRef:
              name: quantum-secret
              key: key
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
        securityContext:
          allowPrivilegeEscalation: false
          runAsNonRoot: true
          runAsUser: 1000
          capabilities:
            drop:
            - ALL

---
# üîç MONITORING S√âCURIT√â
apiVersion: apps/v1
kind: Deployment
metadata:
  name: security-monitoring
  namespace: security-224solutions
spec:
  replicas: 3
  selector:
    matchLabels:
      app: security-monitoring
  template:
    metadata:
      labels:
        app: security-monitoring
    spec:
      containers:
      - name: security-monitoring
        image: 224solutions/security-monitoring:latest
        ports:
        - containerPort: 3002
        env:
        - name: SIEM_API_KEY
          valueFrom:
            secretKeyRef:
              name: siem-secret
              key: api-key
        - name: THREAT_INTELLIGENCE_KEY
          valueFrom:
            secretKeyRef:
              name: threat-secret
              key: api-key
        - name: FRAUD_DETECTION_KEY
          valueFrom:
            secretKeyRef:
              name: fraud-secret
              key: api-key
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"

---
# üö® D√âTECTION D'INTRUSION
apiVersion: apps/v1
kind: Deployment
metadata:
  name: intrusion-detection
  namespace: security-224solutions
spec:
  replicas: 5
  selector:
    matchLabels:
      app: intrusion-detection
  template:
    metadata:
      labels:
        app: intrusion-detection
    spec:
      containers:
      - name: intrusion-detection
        image: 224solutions/intrusion-detection:latest
        ports:
        - containerPort: 3003
        env:
        - name: IDS_RULES_URL
          value: "https://rules.224solutions.com/ids-rules.json"
        - name: ML_MODEL_URL
          value: "https://models.224solutions.com/anomaly-detection.pkl"
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"

---
# üîê GESTION DES CL√âS
apiVersion: apps/v1
kind: Deployment
metadata:
  name: key-management
  namespace: security-224solutions
spec:
  replicas: 3
  selector:
    matchLabels:
      app: key-management
  template:
    metadata:
      labels:
        app: key-management
    spec:
      containers:
      - name: key-management
        image: 224solutions/key-management:latest
        ports:
        - containerPort: 3004
        env:
        - name: VAULT_ADDR
          value: "https://vault.224solutions.com"
        - name: VAULT_TOKEN
          valueFrom:
            secretKeyRef:
              name: vault-secret
              key: token
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"

---
# üõ°Ô∏è FIREWALL APPLICATION
apiVersion: apps/v1
kind: Deployment
metadata:
  name: waf-service
  namespace: security-224solutions
spec:
  replicas: 8
  selector:
    matchLabels:
      app: waf-service
  template:
    metadata:
      labels:
        app: waf-service
    spec:
      containers:
      - name: waf-service
        image: 224solutions/waf-service:latest
        ports:
        - containerPort: 3005
        env:
        - name: WAF_RULES_URL
          value: "https://rules.224solutions.com/waf-rules.json"
        - name: RATE_LIMIT_RPS
          value: "10000"
        - name: BLOCK_THRESHOLD
          value: "100"
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"

---
# üîí CHIFFREMENT END-TO-END
apiVersion: apps/v1
kind: Deployment
metadata:
  name: e2e-encryption
  namespace: security-224solutions
spec:
  replicas: 5
  selector:
    matchLabels:
      app: e2e-encryption
  template:
    metadata:
      labels:
        app: e2e-encryption
    spec:
      containers:
      - name: e2e-encryption
        image: 224solutions/e2e-encryption:latest
        ports:
        - containerPort: 3006
        env:
        - name: E2E_PRIVATE_KEY
          valueFrom:
            secretKeyRef:
              name: e2e-secret
              key: private-key
        - name: E2E_PUBLIC_KEY
          valueFrom:
            secretKeyRef:
              name: e2e-secret
              key: public-key
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"

---
# üö® ALERTES S√âCURIT√â
apiVersion: apps/v1
kind: Deployment
metadata:
  name: security-alerts
  namespace: security-224solutions
spec:
  replicas: 2
  selector:
    matchLabels:
      app: security-alerts
  template:
    metadata:
      labels:
        app: security-alerts
    spec:
      containers:
      - name: security-alerts
        image: 224solutions/security-alerts:latest
        ports:
        - containerPort: 3007
        env:
        - name: SLACK_WEBHOOK
          valueFrom:
            secretKeyRef:
              name: slack-secret
              key: webhook
        - name: EMAIL_SMTP_HOST
          valueFrom:
            secretKeyRef:
              name: email-secret
              key: smtp-host
        - name: SMS_API_KEY
          valueFrom:
            secretKeyRef:
              name: sms-secret
              key: api-key
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"

---
# üîê GESTION DES CERTIFICATS
apiVersion: apps/v1
kind: Deployment
metadata:
  name: certificate-manager
  namespace: security-224solutions
spec:
  replicas: 2
  selector:
    matchLabels:
      app: certificate-manager
  template:
    metadata:
      labels:
        app: certificate-manager
    spec:
      containers:
      - name: certificate-manager
        image: 224solutions/certificate-manager:latest
        ports:
        - containerPort: 3008
        env:
        - name: CERT_AUTHORITY_URL
          value: "https://ca.224solutions.com"
        - name: CERT_RENEWAL_DAYS
          value: "30"
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"

---
# üõ°Ô∏è CONFIGURATION R√âSEAU S√âCURIS√â
apiVersion: v1
kind: NetworkPolicy
metadata:
  name: security-network-policy
  namespace: security-224solutions
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: 224solutions
    - namespaceSelector:
        matchLabels:
          name: monitoring
    ports:
    - protocol: TCP
      port: 3000
    - protocol: TCP
      port: 3001
    - protocol: TCP
      port: 3002
    - protocol: TCP
      port: 3003
    - protocol: TCP
      port: 3004
    - protocol: TCP
      port: 3005
    - protocol: TCP
      port: 3006
    - protocol: TCP
      port: 3007
    - protocol: TCP
      port: 3008
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: 224solutions
    - namespaceSelector:
        matchLabels:
          name: monitoring
    ports:
    - protocol: TCP
      port: 3000
    - protocol: TCP
      port: 3001
    - protocol: TCP
      port: 3002
    - protocol: TCP
      port: 3003
    - protocol: TCP
      port: 3004
    - protocol: TCP
      port: 3005
    - protocol: TCP
      port: 3006
    - protocol: TCP
      port: 3007
    - protocol: TCP
      port: 3008

---
# üîê CONFIGURATION RBAC
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: security-224solutions
  name: security-role
rules:
- apiGroups: [""]
  resources: ["secrets", "configmaps"]
  verbs: ["get", "list", "watch"]
- apiGroups: [""]
  resources: ["pods", "services"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: security-role-binding
  namespace: security-224solutions
subjects:
- kind: ServiceAccount
  name: security-service-account
  namespace: security-224solutions
roleRef:
  kind: Role
  name: security-role
  apiGroup: rbac.authorization.k8s.io

---
# üîê CONFIGURATION SECRETS
apiVersion: v1
kind: Secret
metadata:
  name: jwt-secret
  namespace: security-224solutions
type: Opaque
data:
  secret: <base64-encoded-jwt-secret>

---
apiVersion: v1
kind: Secret
metadata:
  name: oauth-secret
  namespace: security-224solutions
type: Opaque
data:
  client-id: <base64-encoded-oauth-client-id>
  client-secret: <base64-encoded-oauth-client-secret>

---
apiVersion: v1
kind: Secret
metadata:
  name: biometric-secret
  namespace: security-224solutions
type: Opaque
data:
  api-key: <base64-encoded-biometric-api-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: hardware-secret
  namespace: security-224solutions
type: Opaque
data:
  key: <base64-encoded-hardware-security-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: aes-secret
  namespace: security-224solutions
type: Opaque
data:
  key: <base64-encoded-aes-256-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: rsa-secret
  namespace: security-224solutions
type: Opaque
data:
  private-key: <base64-encoded-rsa-4096-private-key>
  public-key: <base64-encoded-rsa-4096-public-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: quantum-secret
  namespace: security-224solutions
type: Opaque
data:
  key: <base64-encoded-quantum-resistant-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: siem-secret
  namespace: security-224solutions
type: Opaque
data:
  api-key: <base64-encoded-siem-api-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: threat-secret
  namespace: security-224solutions
type: Opaque
data:
  api-key: <base64-encoded-threat-intelligence-api-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: fraud-secret
  namespace: security-224solutions
type: Opaque
data:
  api-key: <base64-encoded-fraud-detection-api-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: vault-secret
  namespace: security-224solutions
type: Opaque
data:
  token: <base64-encoded-vault-token>

---
apiVersion: v1
kind: Secret
metadata:
  name: e2e-secret
  namespace: security-224solutions
type: Opaque
data:
  private-key: <base64-encoded-e2e-private-key>
  public-key: <base64-encoded-e2e-public-key>

---
apiVersion: v1
kind: Secret
metadata:
  name: slack-secret
  namespace: security-224solutions
type: Opaque
data:
  webhook: <base64-encoded-slack-webhook>

---
apiVersion: v1
kind: Secret
metadata:
  name: email-secret
  namespace: security-224solutions
type: Opaque
data:
  smtp-host: <base64-encoded-smtp-host>

---
apiVersion: v1
kind: Secret
metadata:
  name: sms-secret
  namespace: security-224solutions
type: Opaque
data:
  api-key: <base64-encoded-sms-api-key>

---
# üîê CONFIGURATION SERVICE ACCOUNT
apiVersion: v1
kind: ServiceAccount
metadata:
  name: security-service-account
  namespace: security-224solutions
  labels:
    app: security
    tier: enterprise
